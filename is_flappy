#!/usr/bin/env python3

import argparse
import logging
import socket
import sys

parser = argparse.ArgumentParser()
parser.add_argument("port", help="port to check", type=int)
args = parser.parse_args()


def tcp_check(host, port):
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        result = s.connect_ex((host, port))
        s.close()
        if result == 0:
            print("{port} is listening on {host}".format(port=port, host=host))
        else:
            print("{port} is NOT listening on {host}".format(port=port, host=host))
    except socket.gaierror:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        result = s.connect_ex((host.strip(), port))
        s.close()
        if result == 0:
            print("{port} is listening on {host}".format(port=port, host=host))
        else:
            print("{port} is NOT listening on {host}".format(port=port, host=host))

for host in sys.stdin:
    tcp_check(host, args.port)
